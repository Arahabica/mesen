# ルーペ機能仕様書

## 概要
モバイル環境で指が画面を隠してしまうことによる描画位置の調整困難を解決するルーペ機能を実装する。

## 機能詳細

### モード遷移
1. **移動モード**（デフォルト）
   - 画像のパン・ズーム操作が可能
   - 指を離すと常にこのモードに戻る

2. **調整モード**
   - 画像を0.5秒長押しで起動
   - ルーペが表示され、タップ位置の微調整が可能
   - ルーペ中心に半透明の黒い円を表示（描画予定位置）

3. **描画モード**
   - 調整モード中、タップ位置が変わらない状態でさらに0.5秒経過で起動
   - ルーペ中心の円が不透明に変化
   - 指を動かすと線の描画開始

### ルーペ仕様
- **形状**: 円形（半径50px）
- **拡大率**: 2倍
- **表示位置**: 
  - 第1優先: タップ位置の左上
  - 第2優先: 右上
  - 第3優先: 左下
  - 第4優先: 右下
- **中心表示**: 描画する線の太さと同じ大きさの円
  - 調整モード: 半透明の黒
  - 描画モード: 不透明の黒

### モード遷移時のフィードバック
1. **視覚的フィードバック**
   - モード切り替え時に画面全体に半透明の白色フラッシュ効果
   - 一瞬（約100ms）表示

2. **触覚的フィードバック**
   - Vibration APIが利用可能なブラウザでは振動
   - 調整モード開始: 短い振動（50ms）
   - 描画モード開始: やや長い振動（100ms）

### 実装上の考慮事項
- タッチイベントの座標を正確に取得
- Canvas上の実際の描画位置との同期
- パフォーマンスを考慮したルーペの再描画
- ブラウザ互換性（Vibration APIのフォールバック）